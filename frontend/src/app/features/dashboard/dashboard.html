<div class="dashboard">
  <!-- AppBar Header -->
  <ejs-appbar cssClass="custom-appbar">
    <span class="appbar-title">ğŸ  Dashboard</span>
    <div class="e-appbar-spacer"></div>
  </ejs-appbar>

  <!-- Quick Stats -->
    <section class="dashboard__stats">
      <app-stat-card
        title="Upcoming Bills"
        [value]="stats().upcomingBills"
        icon="ğŸ“®"
        variant="primary"
        [showViewDetail]="true"
      />
      
      <app-stat-card
        title="Overdue Items"
        [value]="stats().overdueItems"
        icon="âš ï¸"
        [variant]="stats().overdueItems > 0 ? 'error' : 'info'"
        [showViewDetail]="true"
      />
      
      <app-stat-card
        title="Maintenance Tasks"
        [value]="stats().maintenanceTasks"
        icon="ğŸ”§"
        variant="warning"
        [showViewDetail]="true"
      />
      
      <app-stat-card
        title="Budget Usage"
        [value]="stats().budgetStatus.percentageUsed.toFixed(0) + '%'"
        icon="ğŸ’°"
        [variant]="stats().budgetStatus.status === 'critical' ? 'error' : 'success'"
        [showViewDetail]="true"
      />
    </section>

  <!-- Event Calendar Widget (Now Prominent) -->
  <div class="dashboard__calendar-widget">
    <div class="card">
      <div class="widget__header">
        <h2 class="widget__title">
          <span class="widget__icon">ğŸ“…</span>
          Event Calendar
        </h2>
        <div class="widget__legend">
          <span class="legend-item"><span class="legend-dot" style="background: #1b76ff;"></span> Bills</span>
          <span class="legend-item"><span class="legend-dot" style="background: #ff5757;"></span> Urgent</span>
          <span class="legend-item"><span class="legend-dot" style="background: #ff8c42;"></span> Maintenance</span>
          <span class="legend-item"><span class="legend-dot" style="background: #6b5ce7;"></span> Insurance</span>
          <span class="legend-item"><span class="legend-dot" style="background: #a05ce7;"></span> Healthcare</span>
        </div>
      </div>
      
      <div class="widget__content">
        @if (calendarEvents().length > 0) {
          <ejs-schedule
            [selectedDate]="selectedDate"
            [eventSettings]="eventSettings"
            [views]="views"
            [currentView]="'Month'"
            (eventRendered)="onEventRendered($event)"
            (actionComplete)="onActionComplete($event)"
            cssClass="custom-schedule"
            height="600px"
          >
          </ejs-schedule>
        } @else {
          <div class="widget__empty">
            <p>ğŸ“… No upcoming events</p>
            <p>Bills, maintenance tasks, and insurance renewals will appear here.</p>
            <div class="quick-links">
              <a [routerLink]="['/bills']" class="btn btn--outline">Add Bill â†’</a>
              <a [routerLink]="['/maintenance']" class="btn btn--outline">Add Task â†’</a>
            </div>
          </div>
        }
      </div>
    </div>
  </div>

  <!-- Main Content Grid -->
  <div class="dashboard__grid">
      <!-- Budget Chart -->
      @if (budgetChartData().length > 0) {
        <div class="dashboard__chart">
          <div class="card">
            <div class="card-header">
              <h3>Budget Overview</h3>
            </div>
              <div class="card-content">
                <ejs-chart
                  style="display:block; width:100%;"
                  [primaryXAxis]="primaryXAxis"
                  [primaryYAxis]="primaryYAxis"
                  [title]="chartTitle"
                  [tooltip]="tooltip"
                  [height]="'300'"
                  [enableAnimation]="true">
                  <e-series-collection>
                    <e-series 
                      [dataSource]="budgetChartData()" 
                      type='Column' 
                      xName='x' 
                      yName='y' 
                      name='Spent'
                      [marker]="marker"
                      fill='#d4af37'>
                    </e-series>
                  </e-series-collection>
                </ejs-chart>
              </div>
          </div>
        </div>
      } @else {
        <div class="dashboard__chart">
          <div class="card">
            <div class="card-header">
              <h3>Budget Overview</h3>
            </div>
            <div class="card-content">
              <div class="widget__empty">
                <p>ğŸ“Š No budget data available.</p>
                <p>Create budgets in the Financial section to see spending overview.</p>
                <a [routerLink]="['/financial']" class="btn btn--outline">Go to Financial â†’</a>
              </div>
            </div>
          </div>
        </div>
      }

      <!-- Quick Actions Widget -->
      <div class="card card--accent dashboard__quick-actions">
        <div class="widget__header">
          <h2 class="widget__title">
            <span class="widget__icon">âš¡</span>
            Quick Actions
          </h2>
        </div>
        
        <div class="widget__content">
          <div class="quick-actions">
            <a [routerLink]="['/bills']" class="action-button">
              <span class="action-button__icon">ğŸ’³</span>
              <span class="action-button__label">Pay Bill</span>
            </a>
            <a [routerLink]="['/financial']" class="action-button">
              <span class="action-button__icon">ğŸ’°</span>
              <span class="action-button__label">Add Transaction</span>
            </a>
            <a [routerLink]="['/maintenance']" class="action-button">
              <span class="action-button__icon">ğŸ”¨</span>
              <span class="action-button__label">Schedule Task</span>
            </a>
            <a [routerLink]="['/documents']" class="action-button">
              <span class="action-button__icon">ğŸ“„</span>
              <span class="action-button__label">Upload Document</span>
            </a>
            <a [routerLink]="['/healthcare']" class="action-button">
              <span class="action-button__icon">ğŸ¥</span>
              <span class="action-button__label">Healthcare</span>
            </a>
          </div>
        </div>
      </div>
  </div>
</div>

