<div class="insurance">
  <h1 class="page-header">
    üõ°Ô∏è Insurance Center
    <div class="page-header__actions">
      <button class="btn btn--accent" (click)="openPolicyDialog()">
        + Add Policy
      </button>
    </div>
  </h1>

  <section class="insurance__content">
      @if (policies().length > 0) {
        <div class="policy-grid">
          @for (policy of policies(); track policy.id) {
            <div class="policy-card">
              <div class="policy-card__header">
                <span class="policy-card__icon">üõ°Ô∏è</span>
                <span class="badge badge--info">{{ policy.type }}</span>
              </div>
              <h3>{{ policy.provider }}</h3>
              <p class="policy-card__number">Policy #{{ policy.policyNumber }}</p>
              
              <div class="policy-card__details">
                <div class="detail-row">
                  <span>Premium:</span>
                  <span>{{ formatCurrency(policy.premium) }}</span>
                </div>
                <div class="detail-row">
                  <span>Frequency:</span>
                  <span>{{ policy.billingFrequency }}</span>
                </div>
                @if (policy.deductible) {
                  <div class="detail-row">
                    <span>Deductible:</span>
                    <span>{{ formatCurrency(policy.deductible) }}</span>
                  </div>
                }
                <div class="detail-row renewal">
                  <span>Renewal Date:</span>
                  <span>{{ formatDate(policy.renewalDate) }}</span>
                </div>
                @if (getDaysUntilRenewal(policy.renewalDate) <= 30) {
                  <span class="badge badge--warning">Renewing Soon</span>
                }
              </div>
            </div>
          }
        </div>
      } @else {
        <div class="empty-state">
          <span class="empty-state__icon">üõ°Ô∏è</span>
          <h3>No Insurance Policies</h3>
          <p>Add your insurance policies to track renewals and coverage</p>
        </div>
      }
    </section>

    <!-- Add Insurance Policy Dialog -->
    <ejs-dialog
      #policyDialog
      header="Add Insurance Policy"
      [width]="dialogWidth"
      [isModal]="true"
      [visible]="false"
      [animationSettings]="animationSettings"
      [buttons]="policyDialogButtons">
      <ng-template #content>
        <form [formGroup]="policyForm" class="form">
          <div class="form-group">
            <label>Insurance Provider *</label>
            <ejs-textbox formControlName="provider" placeholder="e.g., State Farm, Geico"></ejs-textbox>
          </div>

          <div class="form-group">
            <label>Insurance Type *</label>
            <ejs-dropdownlist
              formControlName="type"
              [dataSource]="insuranceTypes"
              placeholder="Select type">
            </ejs-dropdownlist>
          </div>

          <div class="form-group">
            <label>Policy Number *</label>
            <ejs-textbox formControlName="policyNumber" placeholder="Enter policy number"></ejs-textbox>
          </div>

          <div class="form-group">
            <label>Premium Amount *</label>
            <ejs-numerictextbox
              formControlName="premium"
              [min]="0"
              [step]="10"
              format="c2"
              placeholder="0.00">
            </ejs-numerictextbox>
          </div>

          <div class="form-group">
            <label>Billing Frequency *</label>
            <ejs-dropdownlist
              formControlName="billingFrequency"
              [dataSource]="billingFrequencies"
              placeholder="Select frequency">
            </ejs-dropdownlist>
          </div>

          <div class="form-group">
            <label>Start Date *</label>
            <ejs-datepicker formControlName="startDate"></ejs-datepicker>
          </div>

          <div class="form-group">
            <label>Renewal Date *</label>
            <ejs-datepicker formControlName="renewalDate"></ejs-datepicker>
          </div>

          <div class="form-group">
            <label>Coverage Details *</label>
            <ejs-textbox formControlName="coverage" multiline="true" placeholder="Describe coverage"></ejs-textbox>
          </div>

          <div class="form-group">
            <label>Deductible</label>
            <ejs-numerictextbox
              formControlName="deductible"
              [min]="0"
              [step]="100"
              format="c2"
              placeholder="0.00">
            </ejs-numerictextbox>
          </div>
        </form>
      </ng-template>
    </ejs-dialog>
</div>
