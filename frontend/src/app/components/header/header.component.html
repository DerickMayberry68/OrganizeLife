<!-- BEGIN #header -->
<div id="header" class="app-header" [attr.data-bs-theme]="this.appSettings.appHeaderInverse ? 'dark' : ''">
  <!-- BEGIN navbar-header -->
  <div class="navbar-header">
    @if (this.appSidebarTwo) {
      <button type="button" class="navbar-mobile-toggler" (click)="toggleAppSidebarEndMobile()">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
    }
    <a href="/" class="navbar-brand">
      <img src="HomeSynchronicityLogo_SlimDark.png" alt="HomeSynchronicity" class="navbar-logo">
    </a>
    @if (this.appSettings.appTopMenu && !this.appSettings.appSidebarNone) {
      <button type="button" class="navbar-mobile-toggler" (click)="toggleAppTopMenuMobile()">
        <span class="fa-stack fa-lg text-inverse">
          <i class="far fa-square fa-stack-2x"></i>
          <i class="fa fa-cog fa-stack-1x"></i>
        </span>
      </button>
    }
    @if (this.appSettings.appHeaderMegaMenu) {
      <button type="button" class="navbar-mobile-toggler" (click)="toggleAppHeaderMegaMenuMobile()">
        <span class="fa-stack fa-lg text-inverse">
          <i class="far fa-square fa-stack-2x"></i>
          <i class="fa fa-cog fa-stack-1x"></i>
        </span>
      </button>
    }
    @if (!this.appSettings.appSidebarNone) {
      <button type="button" class="navbar-mobile-toggler" (click)="toggleAppSidebarMobile()">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
    }
    @if (this.appSettings.appTopMenu && this.appSettings.appSidebarNone) {
      <button type="button" class="navbar-mobile-toggler" (click)="toggleAppTopMenuMobile()">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
    }
  </div>
  <!-- END navbar-header -->

  <!-- BEGIN mega-menu -->
  @if (this.appSettings.appHeaderMegaMenu) {
    <div class="collapse d-md-block me-auto" [ngClass]="{ 'd-block': (this.appSettings.appHeaderMegaMenu && this.appSettings.appHeaderMegaMenuMobileToggled) }">
      <div class="navbar-nav">
        <div class="navbar-item dropdown dropdown-lg">
          <a href="javascript:;" class="navbar-link dropdown-toggle d-flex align-items-center" data-bs-toggle="dropdown">
            <i class="fa fa-th-large fa-fw me-1"></i> 
            <span class="d-lg-inline d-md-none">Mega</span>
            <b class="caret ms-1"></b>
          </a>
          <div class="dropdown-menu dropdown-menu-lg">
            Content here
          </div>
        </div>
        <div class="navbar-item">
          <a href="javascript:;" class="navbar-link d-flex align-items-center">
            <i class="fa fa-gem fa-fw me-1"></i>
            <span class="d-lg-inline d-md-none">Client</span>
          </a>
        </div>
        <div class="navbar-item dropdown">
          <a href="javascript:;" class="navbar-link dropdown-toggle d-flex align-items-center" data-bs-toggle="dropdown">
            <i class="fa fa-database fa-fw me-1"></i> 
            <span class="d-lg-inline d-md-none">New</span>
            <b class="caret ms-1"></b>
          </a>
          <div class="dropdown-menu">
            <a href="javascript:;" class="dropdown-item">Action</a>
            <a href="javascript:;" class="dropdown-item">Another action</a>
            <a href="javascript:;" class="dropdown-item">Something else here</a>
            <div class="dropdown-divider"></div>
            <a href="javascript:;" class="dropdown-item">Separated link</a>
            <div class="dropdown-divider"></div>
            <a href="javascript:;" class="dropdown-item">One more separated link</a>
          </div>
        </div>
      </div>
    </div>
  }
  <!-- END mega-menu -->

  <!-- BEGIN nav -->
  <div class="navbar-nav">
    <div class="navbar-item navbar-form">
      <form action="" method="POST" name="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Enter keyword" />
          <button type="submit" class="btn btn-search"><i class="fa fa-search"></i></button>
        </div>
      </form>
    </div>
    <div class="navbar-item">
      <a routerLink="/alerts" class="navbar-link icon alert-bell-link">
        <span class="alert-bell-icon">ðŸ””</span>
        @if (notificationCount() > 0) {
          <span class="badge">{{ notificationCount() }}</span>
        }
      </a>
    </div>
    <div class="navbar-item dropdown">
      <a href="javascript:;" data-bs-toggle="dropdown" class="navbar-link dropdown-toggle icon">
        <span class="alert-preview-icon">ðŸ“‹</span>
      </a>
      <div class="dropdown-menu media-list dropdown-menu-end">
        <div class="dropdown-header">ALERTS ({{ notificationCount() }})</div>
        @if (recentAlerts().length > 0) {
          @for (alert of recentAlerts(); track alert.id) {
            <a 
              [routerLink]="alert.actionUrl || '/alerts'" 
              class="dropdown-item media"
              [class.unread-alert]="!alert.isRead"
            >
              <div class="media-left">
                <div class="alert-icon alert-icon--{{ alert.severity.toLowerCase() }}">
                  {{ getSeverityIcon(alert.severity) }}
                </div>
              </div>
              <div class="media-body">
                <h6 class="media-heading">
                  {{ alert.title }}
                  @if (!alert.isRead) {
                    <span class="badge bg-primary ms-1">New</span>
                  }
                </h6>
                <p class="mb-0">{{ alert.message }}</p>
                <div class="text-muted fs-10px">{{ getRelativeTime(alert.createdAt) }}</div>
              </div>
              @if (!alert.isRead) {
                <div class="media-right">
                  <button 
                    class="btn btn-sm btn-link text-muted"
                    (click)="markAlertAsRead(alert.id, $event)"
                    title="Mark as read"
                  >
                    <i class="fa fa-check"></i>
                  </button>
                </div>
              }
            </a>
          }
        } @else {
          <div class="text-center w-300px py-3">
            No alerts at this time
          </div>
        }
        <div class="dropdown-footer text-center">
          <a routerLink="/alerts" class="text-decoration-none">View all alerts</a>
        </div>
      </div>
    </div>
    @if (this.appSettings.appHeaderLanguageBar) {
      <div class="navbar-item dropdown">
        <a href="javascript:;" class="navbar-link dropdown-toggle" data-bs-toggle="dropdown">
          <span class="fi fi-us" title="us"></span>
          <span class="d-none d-sm-inline ms-1">EN</span> <b class="caret"></b>
        </a>
        <div class="dropdown-menu">
          <a href="javascript:;" class="dropdown-item"><span class="fi fi-us me-2" title="us"></span> English</a>
          <a href="javascript:;" class="dropdown-item"><span class="fi fi-cn me-2" title="cn"></span> Chinese</a>
          <a href="javascript:;" class="dropdown-item"><span class="fi fi-jp me-2" title="jp"></span> Japanese</a>
          <a href="javascript:;" class="dropdown-item"><span class="fi fi-be me-2" title="be"></span> Belgium</a>
          <div class="dropdown-divider"></div>
          <a href="javascript:;" class="dropdown-item text-center">more options</a>
        </div>
      </div>
    }
    <div class="navbar-item navbar-user dropdown">
      <a href="javascript:;" class="navbar-link dropdown-toggle d-flex align-items-center" data-bs-toggle="dropdown">
        <div class="image image-icon bg-primary text-white fw-bold">
          {{ userInitials }}
        </div>
        <span>
          <span class="d-none d-md-inline">{{ userDisplayName }}</span>
          <b class="caret"></b>
        </span>
      </a>
      <div class="dropdown-menu dropdown-menu-end me-1">
        <div class="dropdown-header">
          <span class="d-block fw-bold">{{ userDisplayName }}</span>
          <small class="text-muted">{{ currentUser?.email }}</small>
        </div>
        <div class="dropdown-divider"></div>
        <a routerLink="/profile" class="dropdown-item">
          <i class="fa fa-user-circle fa-fw me-2"></i>Edit Profile
        </a>
        <a routerLink="/settings" class="dropdown-item">
          <i class="fa fa-cog fa-fw me-2"></i>Settings
        </a>
        <div class="dropdown-divider"></div>
        <a href="javascript:;" class="dropdown-item text-danger" (click)="logout()">
          <i class="fa fa-sign-out-alt fa-fw me-2"></i>Log Out
        </a>
      </div>
    </div>
    @if (this.appSidebarTwo) {
      <div class="navbar-divider d-none d-md-block"></div>
      <div class="navbar-item d-none d-md-block">
        <a href="javascript:;" (click)="toggleAppSidebarEnd()" class="navbar-link icon">
          <i class="fa fa-th"></i>
        </a>
      </div>
    }
  </div>
  <!-- END nav -->
</div>
<!-- END #header -->
